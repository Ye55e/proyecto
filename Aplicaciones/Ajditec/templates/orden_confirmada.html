{% extends "./plantilla.html" %}
{% load static %}

{% block contenido %}
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
    .orden-confirmada-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        padding: 2rem;
        margin-bottom: 2rem;
    }
    
    .titulo-exito {
        color: #28a745; /* Verde de éxito */
        font-weight: 700;
        margin-bottom: 1.5rem;
    }
    
    .detalle-orden {
        font-size: 1rem;
        margin-bottom: 0.8rem;
        color: #555;
    }
    
    .mensaje-resaltado {
        background-color: rgba(40, 167, 69, 0.1);
        border-left: 4px solid #28a745;
        padding: 1rem;
        margin: 1.5rem 0;
        border-radius: 0 10px 10px 0;
    }
    
    .btn-volver {
        background-color: #007bff; /* Azul del botón principal */
        border: none;
        padding: 0.8rem 1.5rem;
        font-weight: 600;
        margin-right: 1rem;
        vertical-align: top;
    }
    
    .btn-ver-ordenes {
        background-color: #6c757d; /* Gris para el segundo botón */
        border: none;
        padding: 0.8rem 1.5rem;
        font-weight: 600;
        vertical-align: bottom;

    }
    
    .btn-volver:hover {
        background-color: #0069d9;
        transform: translateY(-2px);
        vertical-align: top;
    }
    
    .btn-ver-ordenes:hover {
        background-color: #5a6268;
        transform: translateY(-2px);
        vertical-align: bottom;
    }
    
    @media (max-width: 768px) {
        .btn-container {
            display: flex;
            flex-direction: column;
        }
        
        .btn-volver, .btn-ver-ordenes {
            width: 100%;
            margin-bottom: 1rem;
            margin-right: 0;
        }
    }
  
</style>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="orden-confirmada-card">
                <div class="row">
                    <div class="col-md-7">
                        <h2 class="titulo-exito mb-4">
                            <i class="fas fa-check-circle"></i> ¡Pedido realizado con éxito!
                        </h2>
                        <p class="detalle-orden mb-4">Número de orden: {{ orden.id_ord }}</p>
                        <p class="detalle-orden mb-4">Fecha: {{ orden.fechacrea_ord }}</p>
                        <p class="detalle-orden mb-4">Método de entrega: {% if metodo_entrega == 'envio' %}Envío a domicilio{% else %}Retiro en local{% endif %}</p>
                        <p class="detalle-orden mb-4">Método de pago: {{ orden.metodo_pago }}</p>
                        <p class="detalle-orden mb-4">Estado: {{ orden.estado_ord }}</p>
                        <p class="detalle-orden mb-4">Total: ${{ registro_pago.total_pago }}</p>
                        
                        <div class="mensaje-resaltado">
                            <h5>¡Gracias por su compra!</h5>
                            <p>Al confirmar su pago recibirá un correo con los detalles de su pedido.</p>
                        </div>
                        
                        <div class="btn-container mt-4">
                            <a href="{% url 'inicio' %}" class="btn btn-primary btn-lg btn-volver">
                                <i class="fas fa-home"></i> Volver al inicio
                            </a>
                            <a href="{% url 'listar_ordenes' %}" class="btn btn-secondary btn-lg btn-ver-ordenes">
                                <i class="fas fa-list-alt"></i> Ver mis órdenes
                            </a>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="resumen-pedido-card">
                            <div class="card-header">
                                <h5 class="mb-0">Resumen del Pedido</h5>
                            </div>
                            <div class="card-body">
                                {% for detalle in detalles_orden %}
                                <div class="producto-item">
                                    <img src="{{ detalle.producto.img_prod.url }}" 
                                         alt="{{ detalle.producto.nomb_prod }}" 
                                         style="width: 40px; height: 40px; object-fit: cover;">
                                    <div class="producto-info">
                                        <h6 class="mb-0">{{ detalle.producto.nomb_prod }}</h6>
                                        <small>{{ detalle.cantidad }} x</small>
                                    </div>
                                    <span class="precio">$ {{ detalle.subtotal|floatformat:2 }}</span>
                                </div>
                                {% endfor %}

                                {% if metodo_entrega == 'envio' %}
                                    <div class="total-row text-danger">
                                        <span>+ Valor adicional por envío (contraentrega)</span>
                                    </div>
                                {% endif %}

                                <div class="total-section">
                                    <div class="total-row">
                                        <span>Subtotal:</span>
                                        <span>$ {{ subtotal|floatformat:2 }}</span>
                                    </div>
                                    <div class="total-row">
                                        <span>Impuestos:</span>
                                        <span>$ {{ impuesto|floatformat:2 }}</span>
                                    </div>
                                    <div class="total-row">
                                        <span>Total:</span>
                                        <span>$ {{ total|floatformat:2 }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}